<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>User Management</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f6f6f6;
        margin: 0;
        padding: 0;
    }
    .header {
        background: #2196f3;
        color: white;
        padding: 15px 25px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .header h2 {
        margin: 0;
    }
    .header button {
        background: white;
        border: none;
        color: #2196f3;
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
        margin-left: 10px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        background: white;
        margin-top: 10px;
    }
    th, td {
        text-align: left;
        padding: 12px;
        border-bottom: 1px solid #ddd;
    }
    th {
        background: #f2f2f2;
    }
    .status {
        display: flex;
        align-items: center;
    }
    .dot {
        height: 10px;
        width: 10px;
        border-radius: 50%;
        display: inline-block;
        margin-right: 8px;
    }
    .active { background-color: green; }
    .inactive { background-color: orange; }
    .suspended { background-color: red; }
    .action button {
        background: none;
        border: none;
        cursor: pointer;
        font-size: 16px;
        margin-right: 8px;
    }
</style>
</head>
<body>

<div class="header">
    <h2>User <strong>Management</strong></h2>
    <div>
        <button onclick="exportToExcel()">Export to Excel</button>
        <button onclick="addUser()">+ Add New User</button>
    </div>
</div>

<table id="userTable">
    <thead>
        <tr>
            <th>#</th>
            <th>Name</th>
            <th>Date Created</th>
            <th>Role</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody id="userBody">
    </tbody>
</table>

<script>
let users = [
    { name: "Michael Holz", date: "04/10/2013", role: "Admin", status: "Active" },
    { name: "Paula Wilson", date: "05/08/2014", role: "Publisher", status: "Active" },
    { name: "Antonio Moreno", date: "11/05/2015", role: "Publisher", status: "Suspended" },
    { name: "Mary Saveley", date: "06/09/2016", role: "Reviewer", status: "Active" },
    { name: "Martin Sommer", date: "12/08/2017", role: "Moderator", status: "Inactive" },
];

function renderTable() {
    const tbody = document.getElementById("userBody");
    tbody.innerHTML = "";
    users.forEach((user, index) => {
        let colorClass = user.status === "Active" ? "active" :
                         user.status === "Inactive" ? "inactive" : "suspended";
        tbody.innerHTML += `
            <tr>
                <td>${index + 1}</td>
                <td>${user.name}</td>
                <td>${user.date}</td>
                <td>${user.role}</td>
                <td class="status"><span class="dot ${colorClass}"></span>${user.status}</td>
                <td class="action">
                    <button onclick="editUser(${index})">⚙️</button>
                    <button onclick="deleteUser(${index})">❌</button>
                </td>
            </tr>
        `;
    });
}

function addUser() {
    const name = prompt("Enter user name:");
    const role = prompt("Enter role:");
    if (name && role) {
        users.push({
            name,
            date: new Date().toLocaleDateString(),
            role,
            status: "Active"
        });
        renderTable();
    }
}

function deleteUser(index) {
    if (confirm("Are you sure you want to delete this user?")) {
        users.splice(index, 1);
        renderTable();
    }
}

function editUser(index) {
    const newStatus = prompt("Enter new status (Active/Inactive/Suspended):", users[index].status);
    if (newStatus) {
        users[index].status = newStatus;
        renderTable();
    }
}

function exportToExcel() {
    let csvContent = "data:text/csv;charset=utf-8,#,Name,Date Created,Role,Status\n";
    users.forEach((u, i) => {
        csvContent += `${i + 1},${u.name},${u.date},${u.role},${u.status}\n`;
    });
    const link = document.createElement("a");
    link.setAttribute("href", encodeURI(csvContent));
    link.setAttribute("download", "users.csv");
    link.click();
}

renderTable();
</script>

</body>
</html>
